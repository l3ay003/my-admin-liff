<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFF Multi-Role</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        body { font-family: 'Kanit', sans-serif; text-align: center; background: #f0f2f5; padding: 20px; }
        .card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 400px; margin: auto; }
        .profile-img { width: 80px; height: 80px; border-radius: 50%; border: 3px solid #00b900; }
        .menu-btn { display: block; width: 100%; padding: 12px; margin: 10px 0; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        
        /* ‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå */
        .admin-section { color: #d9534f; border: 2px dashed #d9534f; padding: 10px; border-radius: 10px; margin-top: 15px; }
        .btn-admin { background: #d9534f; color: white; }
        .btn-member { background: #00b900; color: white; }
        
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="card">
        <div id="loader">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>

        <div id="content" class="hidden">
            <img id="user-img" class="profile-img" src="">
            <h3 id="user-name"></h3>
            <p>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: <b id="user-role"></b></p>
            <hr>

            <button class="menu-btn btn-member">‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</button>
            <button class="menu-btn btn-member">‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>

            <div id="admin-menu" class="admin-section hidden">
                <h4>üõ† ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Admin</h4>
                <button class="menu-btn btn-admin">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
                <button class="menu-btn btn-admin">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            </div>
        </div>
    </div>

    <script>
        const LIFF_ID = "2009201666-JexzIIEn"; 
        const GAS_URL = "https://script.google.com/macros/s/AKfycbyVmkVoJnDEr1gTDCFazu8wQzKV58wMewwxnmEwAeO-sgkCYpZQ74nRwGvIgNcsZmhJFw/exec"; 

        async function main() {
            await liff.init({ liffId: LIFF_ID });
            if (!liff.isLoggedIn()) {
                liff.login();
            } else {
                fetchStatus(liff.getIDToken());
            }
        }

        function fetchStatus(token) {
            fetch(`${GAS_URL}?idToken=${token}`)
                .then(res => res.json())
                .then(data => {
                    document.getElementById('loader').classList.add('hidden');
                    document.getElementById('content').classList.remove('hidden');

                    if (data.success) {
                        document.getElementById('user-name').innerText = data.displayName;
                        document.getElementById('user-img').src = data.pictureUrl;
                        document.getElementById('user-role').innerText = data.role;

                        // ‡∏ñ‡πâ‡∏≤‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡πá‡∏ô Admin ‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏û‡∏¥‡πà‡∏°
                        if (data.role === "Admin") {
                            document.getElementById('admin-menu').classList.remove('hidden');
                        }
                    }
                });
        }
        main();
    </script>
</body>
</html>
